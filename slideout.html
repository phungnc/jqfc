<html>
  <head>
    <meta charset="utf-8">
    <title>SlideOut</title>
<script src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="fingerblast.js"></script>
<script type="text/javascript">

$(function() {

    //if (!eventListeners) addEventListeners();
    $(window).on('load', function () {
      $('#slideDoor').css('webkitTransform','translate3d(-282px,0,0)');
      new FingerBlast('#mobile-content'); 
    });

    !function () {

      var pageX;
      var pageY;
      var slider;
      var deltaX;
      var deltaY;
      var offsetX;
      var lastSlide;
      var startTime;
      var resistance;
      var sliderWidth;
      var slideNumber;
      var isScrolling;
      var scrollableArea;
      var dragableArea;

      var getSlider = function (target) {
        var i, sliders = document.querySelectorAll('#slideDoor');
        for (; target && target !== document; target = target.parentNode) {
          for (i = sliders.length; i--;) { if (sliders[i] === target) return target; }
        }
      }

      var getScroll = function () {
        var translate3d = slider.style.webkitTransform.match(/translate3d\(([^,]*)/);
        return parseInt(translate3d ? translate3d[1] : 0)
      };

      var setSlideNumber = function (offset) {
        var round = offset ? (deltaX < 0 ? 'ceil' : 'floor') : 'round';
        slideNumber = Math[round](getScroll() / ( scrollableArea / slider.children.length) );
        slideNumber += offset;
        slideNumber = Math.min(slideNumber, 0);
        slideNumber = Math.max(-(slider.children.length - 1), slideNumber);
      }

      var onTouchStart = function (e) {
        //console.log("Touch Start");
        slider = getSlider(e.target);

        if (!slider) return;
        var firstItem  = slider.querySelector('li');
        dragableArea   = slider;
        scrollableArea = firstItem.offsetWidth * slider.children.length;
        isScrolling    = undefined;
        sliderWidth    = slider.offsetWidth;
        resistance     = 1;
        lastSlide      = -(slider.children.length - 1);
        startTime      = +new Date;
        pageX          = e.touches[0].pageX;
        pageY          = e.touches[0].pageY;

        //setSlideNumber(0);

        slider.style['-webkit-transition-duration'] = 0;
      };

      var onTouchMove = function (e) {
        //console.log("Touch Move");
        if (e.touches.length > 1 || !slider) return; // Exit if a pinch || no slider



        deltaX = e.touches[0].pageX - pageX;
        deltaY = e.touches[0].pageY - pageY;
        pageX  = e.touches[0].pageX;
        pageY  = e.touches[0].pageY;

        if (typeof isScrolling == 'undefined') {
          isScrolling = Math.abs(deltaY) > Math.abs(deltaX);
        }

        if (isScrolling) return;

        offsetX = (deltaX / resistance) + getScroll();

        e.preventDefault();

        resistance = slideNumber == 0         && deltaX > 0 ? (pageX / sliderWidth) + 1.25 :
                     slideNumber == lastSlide && deltaX < 0 ? (Math.abs(pageX) / sliderWidth) + 1.25 : 1;

        slider.style.webkitTransform = 'translate3d(' + offsetX + 'px,0,0)';
      };

      var onTouchEnd = function (e) {
        //console.log("Touch End");
        if (!slider || isScrolling) return;

        if(e.target.id === "slideDoorClose") {
          slider.style['-webkit-transition-duration'] = '.2s';
          slider.style.webkitTransform = 'translate3d(-282px,0,0)';
          return;
        }


        setSlideNumber(
          (+new Date) - startTime < 1000 && Math.abs(deltaX) > 15 ? (deltaX < 0 ? -1 : 1) : 0
        );
        //console.log(slideNumber);
        slideNumber = slideNumber < -1 ? -1 : slideNumber; 
        offsetX = slideNumber * sliderWidth;
        //offsetX =  sliderWidth;

        slider.style['-webkit-transition-duration'] = '.2s';
        slider.style.webkitTransform = 'translate3d(' + offsetX + 'px,0,0)';




        e = new CustomEvent('slide', {
          detail: { slideNumber: Math.abs(slideNumber) },
          bubbles: true,
          cancelable: true
        });

        slider.parentNode.dispatchEvent(e);
      };

      window.addEventListener('touchstart', onTouchStart);
      window.addEventListener('touchmove', onTouchMove);
      window.addEventListener('touchend', onTouchEnd);

    }();
});
/*
    jQuery(function ($) {

      //$("#Label1").addClass('nrelate_animate_style_nyt flyLabel');

      $("#slideDoorClose").live("click", function () {
        $("#slideDoor").stop().animate({
          // parameter
          "left": "-290px"
        });
      });

      $("#slideDoorOpen").live("click", function () {
        $("#slideDoor").stop().animate({
          // parameter
          "left": "-8px"
        });
      });

    });
*/
</script>
  </head>
  <body>
  <style type="text/css">
    #slideDoor {
      position: relative;
      width: 280px;
      border: 1px solid #999;
      left: -8px;    
    }
    #slideDoorOpen {
      position: absolute;
      width: 30px;
      height: 60px;
      top: 45px;
      right: -32px;
      border:1px solid #999;
      background-color: #999;
      cursor: pointer;
    }
    #slideDoorClose {
      position: absolute;  
      background: #4c5460 url(https://lh4.googleusercontent.com/-RGG4KpyRLcM/T8BtV75Ik9I/AAAAAAAAAEg/rsPKeO7hbjs/s800/x_alt_24x24.png) no-repeat 0 0;
      border:none;
      position:absolute;
      top:10px;
      right:10px;
      width:25px;
      height:25px;
      text-indent:-999em;
      overflow:hidden;
      cursor:pointer;
      padding:0;  
    }
    #slideDoorContent {


    }
  </style>
  <div id="mobile-content">
  <div id="slideDoor">
    <div id="slideDoorOpen"></div>
    <h2>お知らせ</h2>
    <div id="slideDoorClose"></div>
    <div id="slideDoorContent">
        <ul>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/2PM">2PM</a>
        <span dir="ltr">(1)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/AAA">AAA</a>
        <span dir="ltr">(2)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/Acid%20Black%20Cherry">Acid Black Cherry</a>
        <span dir="ltr">(3)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/AI">AI</a>
        <span dir="ltr">(1)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/AK-69">AK-69</a>
        <span dir="ltr">(10)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/AKB48">AKB48</a>
        <span dir="ltr">(13)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/Angela%20Aki">Angela Aki</a>
        <span dir="ltr">(1)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/Arashi">Arashi</a>
        <span dir="ltr">(1)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/Ayaka">Ayaka</a>
        <span dir="ltr">(7)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/Ayaka%20Hirahara">Ayaka Hirahara</a>
        <span dir="ltr">(1)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/BENNIE%20K">BENNIE K</a>
        <span dir="ltr">(2)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/BIGBANG">BIGBANG</a>
        <span dir="ltr">(13)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/BUMP%20OF%20CHICKEN">BUMP OF CHICKEN</a>
        <span dir="ltr">(1)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/Che%27Nelle">Che'Nelle</a>
        <span dir="ltr">(2)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/CHEHON">CHEHON</a>
        <span dir="ltr">(1)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/Chihiro%20Onitsuka">Chihiro Onitsuka</a>
        <span dir="ltr">(1)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/Dreams%20Come%20True">Dreams Come True</a>
        <span dir="ltr">(2)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/ET-KING">ET-KING</a>
        <span dir="ltr">(1)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/EXILE">EXILE</a>
        <span dir="ltr">(1)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/Fukuyama%20Masaharu">Fukuyama Masaharu</a>
        <span dir="ltr">(2)</span>
        </li>
        </ul>      
    </div>
  </div>
  </div>
  </body>
</html>