<html>
  <head>
    <meta charset="utf-8">
    <title>SlideOut</title>
<script src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="fingerblast.js"></script>
<script type="text/javascript">

var Slider = function (selector, options) {
  // body...
  // check for correct selector 
  if(typeof selector === 'undefined') return;
  //
  //if(!(selector.nodeType)){
  //  if($$(selector).length === 0) return;
  //}
  // default options
  //var defaults = {};

  //options = options || {};
  //
  var pageX;
  var pageY;
  var slider;
  var deltaX;
  var deltaY;
  var offsetX;
  var startTime;
  var resistance;
  var sliderWidth;
  var toggleFlag;
  //
  var getSlider = function (target) {
    var i, sliders = document.querySelectorAll(selector);
    for (; target && target !== document; target = target.parentNode) {
      for (i = sliders.length; i--;) { if (sliders[i] === target) return target; }
    }
  }

  var getScroll = function () {
    var translate3d = slider.style.webkitTransform.match(/translate3d\(([^,]*)/);
    return parseInt(translate3d ? translate3d[1] : 0)
  };

  var toggleSlide = function () {
    toggleFlag = Math.round(getScroll() / sliderWidth );
    toggleFlag = toggleFlag > 0 ? 0 : (toggleFlag < -1 ? -1 : toggleFlag);     
  }

  var onTouchStart = function (e) {
    slider = getSlider(e.target);
    if (!slider) return;
    sliderWidth    = slider.offsetWidth;
    resistance     = 1;    
    startTime      = +new Date;
    pageX          = e.touches[0].pageX;
    pageY          = e.touches[0].pageY;
    slider.style['-webkit-transition-duration'] = 0;
  };

  var onTouchMove = function (e) {
    if (e.touches.length > 1 || !slider) return; // Exit if a pinch || no slider
    deltaX = e.touches[0].pageX - pageX;
    deltaY = e.touches[0].pageY - pageY;
    pageX  = e.touches[0].pageX;
    pageY  = e.touches[0].pageY;
    offsetX = (deltaX / resistance) + getScroll();
    e.preventDefault();
    resistance = toggleFlag == 0         && deltaX > 0 ? (pageX / sliderWidth) + 1.5 :
                 toggleFlag == -1 && deltaX < 0 ? (Math.abs(pageX) / sliderWidth) + 1.25 : 1;
    console.log('resistance after: ' + resistance);
    slider.style.webkitTransform = 'translate3d(' + offsetX + 'px,0,0)';
  };

  var onTouchEnd = function (e) {
    if (!slider) return;

    if(e.target.id === "slideDoorClose") {
      slider.style['-webkit-transition-duration'] = '.2s';
      slider.style.webkitTransform = 'translate3d(' + (0-sliderWidth) + 'px,0,0)';
      return;
    }
    toggleSlide();
    offsetX = toggleFlag * sliderWidth;
    slider.style['-webkit-transition-duration'] = '.2s';
    slider.style.webkitTransform = 'translate3d(' + offsetX + 'px,0,0)';
    e = new CustomEvent('slide', {
      detail: { toggleFlag: Math.abs(toggleFlag) },
      bubbles: true,
      cancelable: true
    });

    slider.parentNode.dispatchEvent(e);
  };

  window.addEventListener('touchstart', onTouchStart);
  window.addEventListener('touchmove', onTouchMove);
  window.addEventListener('touchend', onTouchEnd);
}

$(function() {
    $('#slideDoor').css('webkitTransform','translate3d(' + (0 - $('#slideDoor').width()) + 'px,0,0)');
    $(window).on('load', function () {
      new FingerBlast('#mobile-content'); 
    });
    var mySlider = new Slider('#slideDoor');
});

</script>
  </head>
  <body>
  <style type="text/css">
    #slideDoor {
      position: relative;
      width: 90%;
      border: 1px solid #999;
      left: -8px;
    }
    #slideDoorOpen {
      position: absolute;
      width: 12%;
      height: 30%;
      top: 45px;
      right: -12%;
      background-color: #999;
      cursor: pointer;
      text-align: center;
      line-height: 150PX;
      font-size: 60px;
      color: white;
    }
    #slideDoorClose {
      position: absolute;
      border: none;
      top: 10px;
      right: 10px;
      overflow: hidden;
      cursor: pointer;
      padding: 0;
      font-size: 80px;
      background-color: red;
    }
    #slideDoorContent {
      margin-top: 50px;
    }
  </style>
  <div id="mobile-content">
  <div id="slideDoor">
    <div id="slideDoorOpen">>></div>
    <h2>お知らせ</h2>
    <div id="slideDoorClose">[X]</div>
    <div id="slideDoorContent">
        <ul>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/2PM">2PM</a>
        <span dir="ltr">(1)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/AAA">AAA</a>
        <span dir="ltr">(2)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/Acid%20Black%20Cherry">Acid Black Cherry</a>
        <span dir="ltr">(3)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/AI">AI</a>
        <span dir="ltr">(1)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/AK-69">AK-69</a>
        <span dir="ltr">(10)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/AKB48">AKB48</a>
        <span dir="ltr">(13)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/Angela%20Aki">Angela Aki</a>
        <span dir="ltr">(1)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/Arashi">Arashi</a>
        <span dir="ltr">(1)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/Ayaka">Ayaka</a>
        <span dir="ltr">(7)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/Ayaka%20Hirahara">Ayaka Hirahara</a>
        <span dir="ltr">(1)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/BENNIE%20K">BENNIE K</a>
        <span dir="ltr">(2)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/BIGBANG">BIGBANG</a>
        <span dir="ltr">(13)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/BUMP%20OF%20CHICKEN">BUMP OF CHICKEN</a>
        <span dir="ltr">(1)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/Che%27Nelle">Che'Nelle</a>
        <span dir="ltr">(2)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/CHEHON">CHEHON</a>
        <span dir="ltr">(1)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/Chihiro%20Onitsuka">Chihiro Onitsuka</a>
        <span dir="ltr">(1)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/Dreams%20Come%20True">Dreams Come True</a>
        <span dir="ltr">(2)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/ET-KING">ET-KING</a>
        <span dir="ltr">(1)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/EXILE">EXILE</a>
        <span dir="ltr">(1)</span>
        </li>
        <li>
        <a dir="ltr" href="http://jmusictube.blogspot.com/search/label/Fukuyama%20Masaharu">Fukuyama Masaharu</a>
        <span dir="ltr">(2)</span>
        </li>
        </ul>      
    </div>
  </div>
  </div>
  </body>
</html>